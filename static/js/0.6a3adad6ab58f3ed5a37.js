webpackJsonp([0],{Cdx3:function(e,t,i){var n=i("sB3e"),a=i("lktj");i("uqUo")("keys",function(){return function(e){return a(n(e))}})},IbwH:function(e,t,i){"use strict";var n=i("14gb"),a={name:"TabTit",props:["item","index","selected","deleteVisible","repeatable"],data:function(){return{isHnputHover:!1,note:"",editableTit:!1}},computed:{deletable:function(){return this.item.deleted&&""===this.item.filename},editable:function(){return this.item.oldname!==this.item.filename},addable:function(){return""===this.item.oldname}},watch:{repeatable:function(){this.repeatable&&this.$message.error("文件名字不能重复")}},mounted:function(){var e=this;n.a.$on("showEditName",function(){e.editableTit=!1})},methods:{showEditTit:function(){this.editableTit=!0,this.changeWidth()},deleteFiles:function(e){this.$set(this.item,"deleted",!0),this.$set(this.item,"filename",""),n.a.$emit("onDeleteFiles",e)},changeTab:function(e){this.$emit("onchangeTab",e)},onNameChanged:function(){this.editableTit=!1,this.$set(this.item,"editable",!0),n.a.$emit("onNameChangedHandle",{deletable:this.deletable,editable:this.editable}),n.a.$emit("repeatFilename",this.item.filename)},changeWidth:function(){this.$refs.inputWidth.style.width=this.$refs.widthName.clientWidth+20+"px"}}},s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"tabTit",class:{hide:e.item.deleted,active:e.selected===e.index}},[i("span",{directives:[{name:"show",rawName:"v-show",value:!e.editableTit,expression:"!editableTit"}],staticClass:"fileName",on:{click:function(t){e.changeTab(e.index)},dblclick:e.showEditTit}},[e._v(e._s(e.item.filename))]),e._v(" "),i("span",{ref:"widthName",staticClass:"nameWidth"},[e._v(e._s(e.item.filename))]),e._v(" "),i("input",{directives:[{name:"show",rawName:"v-show",value:e.editableTit,expression:"editableTit"},{name:"model",rawName:"v-model",value:e.item.filename,expression:"item.filename"}],ref:"inputWidth",staticClass:"inputHover",attrs:{type:"text"},domProps:{value:e.item.filename},on:{change:e.onNameChanged,keyup:e.changeWidth,input:function(t){t.target.composing||e.$set(e.item,"filename",t.target.value)}}}),e._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:e.deleteVisible,expression:"deleteVisible"}],staticClass:"el-icon-delete",on:{click:function(t){e.deleteFiles(e.index)}}})])},staticRenderFns:[]};var o=i("VU/8")(a,s,!1,function(e){i("arOV")},"data-v-50bb3028",null);t.a=o.exports},Jwml:function(e,t){},TmV0:function(e,t,i){i("fZOM"),e.exports=i("FeBl").Object.values},arOV:function(e,t){},bUSi:function(e,t,i){"use strict";var n=i("14gb"),a={name:"File",props:["item","index"],data:function(){return{editContent:!1}},watch:{"item.content":function(){Prism.highlightAll()}},computed:{highlightedContent:function(){if(this.item.content){if(!this.item.language)return this.item.content;var e=this.item.language.toLowerCase();try{return Prism.highlight(this.item.content,Prism.languages[e],e)}catch(e){return this.item.content}}}},mounted:function(){var e=this;this.$refs.contentHeight.$el.children[0].style.border="1px solid #dcdfe6",this.item.content||(this.editContent=!0),n.a.$on("changeEditContent",function(){e.editContent=!1}),n.a.$on("changeContent",function(){e.item.content||(e.editContent=!0)}),n.a.$on("showFileDetail",function(){e.editContent=!1})},methods:{onEditContent:function(){this.editContent=!0,n.a.$emit("changeSave")},contentChanged:function(e){this.editContent=!0,this.$set(this.item,"editable",!0),n.a.$emit("onContentChanged",e)}}},s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"preContent"},[i("pre",{directives:[{name:"show",rawName:"v-show",value:!e.editContent,expression:"!editContent"}],on:{dblclick:e.onEditContent}},[e._v("      "),i("div",{staticClass:"fileContent",domProps:{innerHTML:e._s(e.highlightedContent)}}),e._v("\n    ")]),e._v(" "),i("el-input",{directives:[{name:"show",rawName:"v-show",value:e.editContent,expression:"editContent"}],ref:"contentHeight",attrs:{type:"textarea",autosize:{minRows:20},placeholder:"请输入文件内容"},on:{change:function(t){e.contentChanged(e.index)}},model:{value:e.item.content,callback:function(t){e.$set(e.item,"content",t)},expression:"item.content"}})],1)},staticRenderFns:[]};var o=i("VU/8")(a,s,!1,function(e){i("pAsz")},"data-v-b9887a2a",null);t.a=o.exports},fZOM:function(e,t,i){var n=i("kM2E"),a=i("mbce")(!1);n(n.S,"Object",{values:function(e){return a(e)}})},fZjL:function(e,t,i){e.exports={default:i("jFbC"),__esModule:!0}},gRE1:function(e,t,i){e.exports={default:i("TmV0"),__esModule:!0}},jFbC:function(e,t,i){i("Cdx3"),e.exports=i("FeBl").Object.keys},mbce:function(e,t,i){var n=i("lktj"),a=i("TcQ7"),s=i("NpIQ").f;e.exports=function(e){return function(t){for(var i,o=a(t),l=n(o),d=l.length,c=0,r=[];d>c;)s.call(o,i=l[c++])&&r.push(e?[i,o[i]]:o[i]);return r}}},pAsz:function(e,t){},qksd:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("gRE1"),a=i.n(n),s=i("fZjL"),o=i.n(s),l=i("mtWM"),d=i.n(l),c=i("14gb"),r=i("IbwH"),h=i("zxlW"),u=i("bUSi"),f={name:"Gist",components:{Load:h.a,TabTit:r.a,File:u.a},data:function(){return{id:this.$route.query.id,hideLoad:!1,hideDetails:!0,repeatable:!1,activeName:"",selected:0,newFileIndex:0,description:"",files:[],fileCRUD:{}}},beforeRouteUpdate:function(e,t,i){var n=this;0!==o()(this.fileCRUD).length?this.$confirm("检测到未保存的内容，是否在离开页面前保存修改？","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"保存",cancelButtonText:"放弃修改"}).then(function(){n.onUpdateItem(),n.fileCRUD={},n.id=e.query.id,n.getFiles(n.id),c.a.$emit("addWidth"),i()}).catch(function(t){n.$message({type:"info",message:"cancel"===t?"放弃保存并离开页面":"停留在当前页面"}),n.fileCRUD={},n.hideLoad=!1,n.id=e.query.id,n.getFiles(n.id),i()}):(this.hideLoad=!1,this.fileCRUD={},this.id=e.query.id,this.getFiles(this.id),i())},computed:{savable:function(){return this.fileCRUD.deletable||this.fileCRUD.editable||this.fileCRUD.addable},deleteVisible:function(){return this.files.filter(function(e){return!e.deleted}).length>1}},mounted:function(){var e=this;c.a.$on("hideGistDetails",function(){e.hideLoad=!0,e.hideDetails=!0}),c.a.$on("showDetails",function(){e.hideLoad=!1,e.hideDetails=!0}),this.getFiles(this.id),c.a.$on("onNameChangedHandle",function(t){e.fileCRUD=t}),c.a.$on("onContentChanged",function(){e.$set(e.fileCRUD,"editable",!0)}),c.a.$on("onDeleteFiles",function(t){e.$set(e.fileCRUD,"deletable",!0);for(var i=e.files,n=0;n<i.length;n++)if(void 0===i[n].deleted){e.selected=n;break}}),c.a.$on("defaultSelected",function(){e.selected=0}),c.a.$on("repeatFilename",function(t){e.files.filter(function(e){return e.filename===t}).length>1&&(e.repeatable=!0)})},methods:{getFiles:function(e){var t=this;d.a.get("https://api.github.com/gists/"+e,{headers:{Authorization:"token "+localStorage.getItem("token")}}).then(function(e){t.hideLoad=!0,t.hideDetails=!1,t.description=e.data.description,t.files=a()(e.data.files),t.files.forEach(function(e){e.oldname=e.filename}),t.activeName=t.files[0].filename}).catch()},onChangeDesc:function(){this.$set(this.fileCRUD,"editable",!0)},onChangeTabHandle:function(e){this.selected=e,c.a.$emit("changeContent",e)},addFile:function(){var e="file_"+this.newFileIndex++;this.files.push({filename:e,content:""}),this.selected=this.files.length-1,c.a.$emit("showEditContent")},onUpdateItem:function(){var e=this,t={};t.description=this.description,this.description&&0===this.description.length?alert("详情描述不能为空"):(t.files={},this.files.forEach(function(e){void 0!==e.oldname?(e.editable&&(t.files[e.oldname]={filename:e.filename,content:e.content}),e.deleted&&(t.files[e.oldname]=null)):t.files[e.filename]={content:e.content}}),d.a.patch("https://api.github.com/gists/"+this.id,t,{headers:{Authorization:"token "+localStorage.getItem("token")}}).then(function(t){e.files=a()(t.data.files),e.files.forEach(function(e){e.oldname=e.filename}),e.open(),c.a.$emit("updateList",{id:e.id,files:e.files,description:e.description}),c.a.$emit("changeEditContent"),e.fileCRUD={},e.selected=0}).catch())},open:function(){this.$message({message:"恭喜你，保存成功",type:"success"})}}},m={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("Load",{attrs:{hideLoad:e.hideLoad}}),e._v(" "),i("div",{class:{hide:e.hideDetails}},[i("el-input",{attrs:{type:"textarea",rel:"inputWidth",autosize:""},on:{change:e.onChangeDesc},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),e._v(" "),i("div",{staticClass:"height20"}),e._v(" "),i("div",{staticClass:"tab-tit clear"},[e._l(e.files,function(t,n){return i("TabTit",{key:n,staticClass:"fl",attrs:{item:t,index:n,selected:e.selected,deleteVisible:e.deleteVisible,repeatable:e.repeatable},on:{onchangeTab:function(t){e.onChangeTabHandle(n)}}})}),e._v(" "),i("span",{staticClass:"gistAdd fl"},[i("i",{staticClass:"el-icon-circle-plus-outline",on:{click:e.addFile}})])],2),e._v(" "),e._l(e.files,function(t,n){return i("File",{directives:[{name:"show",rawName:"v-show",value:e.selected===n,expression:"selected === index"}],key:n,attrs:{item:t,index:n}})}),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.savable,expression:"savable"}],staticClass:"btn"},[i("el-button",{attrs:{type:"primary",size:"medium",disabled:!e.savable},on:{click:e.onUpdateItem}},[e._v("\n          保存\n        ")])],1)],2)],1)},staticRenderFns:[]};var p=i("VU/8")(f,m,!1,function(e){i("Jwml")},"data-v-16785d3a",null);t.default=p.exports},uqUo:function(e,t,i){var n=i("kM2E"),a=i("FeBl"),s=i("S82l");e.exports=function(e,t){var i=(a.Object||{})[e]||Object[e],o={};o[e]=t(i),n(n.S+n.F*s(function(){i(1)}),"Object",o)}}});
//# sourceMappingURL=0.6a3adad6ab58f3ed5a37.js.map